# Headless Visitor (Leapcell)

Small service that an external cron can hit every 15 minutes. It immediately returns and then runs a **headless Playwright** browser that opens a target URL and **stays on that page for 14 minutes**.

## Endpoints
- `GET /run?token=YOUR_SECRET[&url=ENCODED_URL]` – trigger a run (responds `202` immediately)
- `GET /status` – show last/active run status
- `GET /healthz` – simple health probe

## Environment Variables
- `CRON_SECRET` (required): shared secret for `/run`
- `TARGET_URL` (optional): default URL if not supplied by query string
- `STAY_MINUTES` (optional, default `14`)
- `PORT` (Leapcell defaults to `8080`)

## Deploy on Leapcell

1) **Push this repo to GitHub** and connect it when creating a Leapcell Service (see their “Connect to GitHub” doc).  
2) In the “Create Service” form use:
   - **Runtime:** Node.js
   - **Build Command:** `sh prepare_playwright_env.sh && npm install`
   - **Start Command:** `npm run start`
   - **Port:** `8080`  
   (These follow Leapcell’s Playwright example.)  
3) Add env vars: `CRON_SECRET`, optional `TARGET_URL`, optional `STAY_MINUTES`.  
4) Deploy. You’ll get a URL like `https://your-app.leapcell.dev`.

## Hook up cron-job.org (every 15 min)

Create a new job in cron-job.org that `GET`s:

